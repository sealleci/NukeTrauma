import{j as e,I as k,S as Le,M as $}from"./ui-1ada5940.js";import{c as ye,d as P,r as a,a as Ce}from"./react-d374afb9.js";import{w as Re}from"./map-50aafcb0.js";import{u as we,g as D,i as Ne,r as Ee,a as Ie,b as Me,c as Te,d as De}from"./echart-c7ccfee9.js";import{u as ke,d as Pe}from"./lang-820134cf.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function c(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(r){if(r.ep)return;r.ep=!0;const l=c(r);fetch(r.href,l)}})();var H={},G=ye;H.createRoot=G.createRoot,H.hydrateRoot=G.hydrateRoot;const W=P()(t=>({type:"neco_arc",headImage:"",setCharacter:(n,c)=>t(()=>({type:n,headImage:c}))})),R=P()(t=>({language:"zh_cn",uiTranslation:null,dialogue:null,setLanguage:n=>t(()=>({language:n})),setUiTranslation:n=>t(()=>({uiTranslation:n})),setDialogue:n=>t(()=>({dialogue:n}))})),N=P()((t,n)=>({regionList:[],geoIndex:0,finalRegionList:[],setRegionList:c=>t(()=>({regionList:c})),updateFinalRegionList:()=>t(()=>({finalRegionList:n().regionList})),clearFinalRegionList:()=>t(()=>({finalRegionList:[]}))})),b=P()(t=>({prevCharacter:"neco_arc",prevRegion:"greeting",prevSubNumeric:"",prevLanguage:"zh_cn",curSentence:"",setPrevCharacter:n=>t({prevCharacter:n}),setPrevRegion:n=>t({prevRegion:n}),setPrevSubNumeric:n=>t({prevSubNumeric:n}),setPrevLanguage:n=>t({prevLanguage:n}),setCurSentence:n=>t(()=>({curSentence:n}))}));function K(t){const n=Array.from(t);for(let c=n.length-1;c>0;c-=1){const o=Math.floor(Math.random()*(c+1));[n[c],n[o]]=[n[o],n[c]]}return n}function J(t,n){return Math.floor(Math.random()*(n-t+1)+t)}function ee(){const t=a.useRef(null),n=R(u=>u.dialogue),c=a.useRef(!0),o=b(u=>u.prevCharacter),r=b(u=>u.prevRegion),l=b(u=>u.prevSubNumeric),d=b(u=>u.prevLanguage),j=b(u=>u.curSentence),g=b(u=>u.setPrevCharacter),x=b(u=>u.setPrevRegion),m=b(u=>u.setPrevSubNumeric),f=b(u=>u.setPrevLanguage),p=b(u=>u.setCurSentence),S=W(u=>u.type),E=N(u=>u.finalRegionList),I=R(u=>u.language),F=N(u=>u.clearFinalRegionList);function B(){t.current&&t.current.classList.toggle("dialogue_bubble--invisible")}const _=a.useCallback((u,y,U,O)=>{if(!n)return"";const C=n[u];if(!C)return"";let w="";for(;y.length>0;){if(y=K(y),C[y[0]]){w=y[0];break}y.shift()}C[w]||(w="general");const s=C[w];let i="";if(U===""){const h=K(Object.keys(s));if(h.length<=0)return"";i=h[0]}else i=U;const v=s[i];return!v||!v[O]?"":(x(w),m(i),v[O])},[n,x,m]);return a.useEffect(()=>{!c.current||!n||(p(_(o,[r],l,d)),c.current=!1)},[n,o,r,l,d,p,_]),a.useEffect(()=>{S!==o&&(p(_(S,["greeting"],"",d)),g(S))},[S,o,d,p,_,g]),a.useEffect(()=>{E.length<=0||(p(_(o,E,"",d)),F())},[E,o,d,p,_,F]),a.useEffect(()=>{I!==d&&(p(_(o,[r],l,I)),f(I))},[I,o,r,l,d,p,_,f]),e.jsxs("div",{className:"dialogue_bubble",ref:t,children:[e.jsxs("div",{className:"dialogue_bubble__switch",onClick:B,children:[e.jsx(k,{children:"visibility"}),e.jsx(k,{children:"forward"}),e.jsx(k,{children:"visibility_off"})]}),e.jsx("div",{className:"dialogue_bubble__content",children:e.jsx("span",{children:j})})]})}const ne=a.memo(()=>{const t=R(o=>o.language),n=R(o=>o.setLanguage);function c(o){n(o.target.value)}return e.jsxs("div",{className:"language_select",children:[e.jsx(k,{children:"translate"}),e.jsxs(Le,{value:t,onChange:c,children:[e.jsx($,{value:"en",children:"English"}),e.jsx($,{value:"zh_cn",children:"中文"}),e.jsx($,{value:"ru",children:"Русский"})]})]})});function q({text:t}){return e.jsx("div",{className:"console_label",children:t})}const te=""+new URL("meowscarada-8f30ae9e.svg",import.meta.url).href,re=""+new URL("neco_arc-a0645750.svg",import.meta.url).href,se=""+new URL("lopunny-ed23b7c3.svg",import.meta.url).href,ce=""+new URL("vaporeon-460baefb.svg",import.meta.url).href,ae=""+new URL("neco_arc-b9a98032.svg",import.meta.url).href,oe=""+new URL("lopunny-252a1372.svg",import.meta.url).href,ie=""+new URL("meowscarada-b414bb30.svg",import.meta.url).href,le=""+new URL("vaporeon-0cf3d389.svg",import.meta.url).href;const A=[{icon:ae,name:"neco_arc",headImage:re},{icon:le,name:"vaporeon",headImage:ce},{icon:oe,name:"lopunny",headImage:se},{icon:ie,name:"meowscarada",headImage:te}],ue=a.memo(()=>{const t=a.useRef(!0),n=W(r=>r.setCharacter),c=b(r=>r.prevCharacter),o=a.useCallback(r=>{var l;return(l=A.find(d=>d.name===r))==null?void 0:l.headImage},[]);return a.useEffect(()=>{if(!t.current)return;const r=o(c);r?n(c,r):n(A[0].name,A[0].headImage),t.current=!1},[c,n,o]),e.jsx("div",{className:"secretary_list",children:A.map((r,l)=>e.jsx("div",{className:"secretary_list__item",onClick:()=>n(r.name,r.headImage),children:e.jsx("img",{src:r.icon,alt:r.name})},l))})}),L=P()(t=>({launchSignal:!1,cancelSignal:!1,relocateSignal:!1,setLaunchSignal:n=>t(()=>({launchSignal:n})),setCancelSignal:n=>t(()=>({cancelSignal:n})),setRelocateSignal:n=>t(()=>({relocateSignal:n}))})),de=""+new URL("cancel-ac8fdd1a.svg",import.meta.url).href,ge=""+new URL("launch-e6206def.svg",import.meta.url).href;function me({isWithLabel:t,text:n=""}){const c=L(r=>r.setCancelSignal);function o(){c(!0)}return e.jsxs("div",{className:"launch_cancel_btn launch_btn",onClick:o,children:[e.jsx("div",{className:"launch_btn__circle",children:e.jsx("div",{children:e.jsx("img",{src:de,alt:"cancel"})})}),t&&e.jsx(q,{text:n})]})}function fe({isWithLabel:t,text:n=""}){const c=L(d=>d.setLaunchSignal),o=N(d=>d.regionList),r=N(d=>d.updateFinalRegionList);function l(){r(),o.length!==0&&c(!0)}return e.jsxs("div",{className:"launch_confirm_btn launch_btn",onClick:l,children:[e.jsx("div",{className:"launch_btn__circle",children:e.jsx("div",{children:e.jsx("img",{src:ge,alt:"launch"})})}),t&&e.jsx(q,{text:n})]})}const he=""+new URL("body-e1c4ec9d.svg",import.meta.url).href;function Ue(){const t=W(n=>n.headImage);return e.jsxs("div",{className:"secretary",style:{opacity:1},children:[e.jsx("div",{className:"secretary__head",children:e.jsx("img",{src:t,alt:"head"})}),e.jsx("div",{className:"secretary__body",children:e.jsx("img",{src:he,alt:"body"})})]})}function Oe(){return e.jsxs("div",{className:"secretary_main",children:[e.jsx(ne,{}),e.jsx(ee,{}),e.jsx(Ue,{})]})}function ze(){return e.jsx("div",{className:"secretary_bg"})}function Fe(){return e.jsxs("div",{className:"secretary_display",children:[e.jsx(Oe,{}),e.jsx(ze,{})]})}function Be(){const[t,n]=a.useState(!1),c=a.useRef(null);function o(){c.current&&(t?c.current.classList.remove("secretary_change_bar--extended"):c.current.classList.add("secretary_change_bar--extended"),n(!t))}return e.jsxs("div",{className:"secretary_change_bar",ref:c,children:[e.jsx(ue,{}),e.jsxs("div",{className:"secretary_change_bar__icon",onClick:o,children:[e.jsx("div",{children:e.jsx(k,{children:"arrow_back_ios_new"})}),e.jsx("div",{children:e.jsx(k,{children:"favorite"})})]})]})}function Ae(){return e.jsxs("div",{className:"secretary_scene",children:[e.jsx(Fe,{}),e.jsx(Be,{})]})}function We({text:t}){const n=N(c=>c.regionList);return e.jsxs("div",{className:"selected_region_cnt",children:[e.jsx("div",{className:"selected_region_cnt__value",children:n.length}),e.jsx(q,{text:t})]})}function $e(){const t=R(c=>c.language),n=R(c=>c.uiTranslation);return e.jsxs("div",{className:"captain_console",children:[e.jsx(me,{isWithLabel:!0,text:n?n.launch_cancel[t]:""}),e.jsx(We,{text:n?n.selected_region[t]:""}),e.jsx(fe,{isWithLabel:!0,text:n?n.launch_confirm[t]:""})]})}function He(){return e.jsxs("div",{className:"captain_cabin",children:[e.jsx(Ae,{}),e.jsx($e,{})]})}function Ze({regionListLength:t}){return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:t>0?"console_wrapper console_wrapper__l":"console_wrapper console_wrapper__l console_wrapper--invisible",children:e.jsx(me,{isWithLabel:!1})}),e.jsx("div",{className:t>0?"console_wrapper console_wrapper__r":"console_wrapper console_wrapper__r console_wrapper--invisible",children:e.jsx(fe,{isWithLabel:!1})})]})}function Xe(){const t=W(n=>n.headImage);return e.jsxs("div",{className:"secretary_scene--mobile",children:[e.jsx("div",{className:"secretary__head--mobile",children:e.jsx("img",{src:t,alt:"head"})}),e.jsx(ee,{})]})}function Ye(){const t=N(n=>n.regionList);return e.jsxs("div",{className:"captain_cabin--mobile",children:[e.jsx(Ze,{regionListLength:t.length}),e.jsx(Xe,{}),e.jsx(ue,{})]})}const pe=P()(t=>({count:0,increase:n=>t(c=>({count:c.count+n}))})),Z=P()(t=>({isSmallScreen:!1,setIsSmallScreen:n=>t(()=>({isSmallScreen:n}))}));we([Ie,Me,Te,De]);const X=1,Y=50,ve=5,xe=[37.6175,55.7519],V=68,Ve={backgroundColor:"transparent",animationDelayUpdate:0,animationDurationUpdate:V,geo:{show:!0,roam:!1,map:"world",selectedMode:"multiple",scaleLimit:{min:X,max:Y},itemStyle:{areaColor:"#DAD4B5"},label:{color:"white"},emphasis:{label:{color:"white",show:!0,textBorderWidth:3,textBorderColor:"black",fontSize:"1.5rem",fontFamily:"Times New Roman"},itemStyle:{areaColor:"#E25E3E"}},select:{label:{color:"white",show:!0,textBorderWidth:3,textBorderColor:"black",fontSize:"1.5rem",fontFamily:"Times New Roman"},itemStyle:{areaColor:"#C63D2F"}},center:xe,zoom:ve}},qe={width:"100%",height:"100%",border:"none",padding:"0",margin:"0"};function Ge(t){let n=0;return t.forEach(c=>{switch(c){case"Russia":n+=J(0,5e3);break;case"Greenland":n+=0;break;case"Venezuela":n+=666;break;default:n+=J(5e3,2e4);break}}),n}function Q(t,n){return Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2))}const Ke=a.memo(({style:t,settings:n,loading:c,theme:o})=>{const r=a.useRef(!1),l=a.useRef(!0),d=a.useRef(!0),j=a.useRef(!0),g=a.useRef(5),x=a.useRef(0),m=a.useRef(null),f=a.useRef(null),p=N(s=>s.regionList),S=N(s=>s.setRegionList),E=L(s=>s.launchSignal),I=L(s=>s.setLaunchSignal),F=L(s=>s.cancelSignal),B=L(s=>s.setCancelSignal),_=pe(s=>s.increase),u=L(s=>s.relocateSignal),y=L(s=>s.setRelocateSignal),U=a.useCallback(s=>{if(s.targetTouches.length<2||!m.current||!l.current)return;const i=D(m.current),v=s.targetTouches[0],h=s.targetTouches[1],z={x:v.clientX,y:v.clientY},M={x:h.clientX,y:h.clientY},T=Q(z,M);x.current===0&&(x.current=T);const be=g.current*(T/x.current);g.current=Math.min(Math.max(be,X),Y),Math.abs(T-x.current)>1e-6&&(i.setOption({geo:{zoom:g.current}},{lazyUpdate:!0,silent:!0}),l.current=!1,setTimeout(()=>{l.current=!0},V),r.current=!0),x.current=T},[]),O=a.useCallback(()=>{x.current=0,r.current=!1},[]),C=a.useCallback(s=>{if(!m.current||!d.current)return;const i=1.4,v=D(m.current);s.deltaY<0?g.current*=i:g.current/=i,g.current=Math.min(Math.max(g.current,X),Y),v.setOption({geo:{zoom:g.current}},{lazyUpdate:!0,silent:!0}),d.current=!1,setTimeout(()=>{d.current=!0},20)},[]),w=a.useCallback(s=>{if(!m.current||!f.current||r.current)return;const i=6,v=D(m.current),h=v.getOption().geo[0].center,z=Q({x:s.offsetX,y:s.offsetY},{x:f.current.x,y:f.current.y}),M=v.convertFromPixel({geoIndex:0},[f.current.x,f.current.y]),T=v.convertFromPixel({geoIndex:0},[s.offsetX,s.offsetY]);z>1e-6&&j.current&&(v.setOption({geo:{center:[h[0]-(T[0]-M[0])*i,h[1]-(T[1]-M[1])*i]}},{lazyUpdate:!0,silent:!0}),j.current=!1,setTimeout(()=>{j.current=!0},V)),f.current={x:s.offsetX,y:s.offsetY}},[]);return a.useEffect(()=>{const s=m.current;let i=null;function v(){i==null||i.resize()}return s&&(i=Ne(m.current,o),i.on("geoselectchanged",h=>{S(h.allSelected[0].name)}),i.getZr().on("mousemove",w),i.getZr().on("mousedown",h=>{f.current={x:h.offsetX,y:h.offsetY}}),i.getZr().on("mouseup",()=>{f.current=null}),i.getZr().on("mousewheel",h=>{C(h.event)}),s.addEventListener("touchmove",U),s.addEventListener("touchend",O),s.addEventListener("wheel",C),Ee("world",Re)),window.addEventListener("resize",v),()=>{var h,z,M;s==null||s.removeEventListener("touchmove",U),s==null||s.removeEventListener("touchend",O),s==null||s.removeEventListener("wheel",C),i==null||i.off("geoselectchanged"),(h=i==null?void 0:i.getZr())==null||h.off("mousemove"),(z=i==null?void 0:i.getZr())==null||z.off("mouseup"),(M=i==null?void 0:i.getZr())==null||M.off("mousedown"),i==null||i.dispose(),window.removeEventListener("resize",v)}},[o,S,U,O,C,w]),a.useEffect(()=>{if(!m.current)return;D(m.current).setOption(Ve,n)},[n,o]),a.useEffect(()=>{if(!m.current)return;const s=D(m.current);c?s.showLoading():s.hideLoading()},[c,o]),a.useEffect(()=>{if(!m.current||!E&&!F)return;const s=D(m.current);E&&_(Ge(p)),p.forEach(i=>{s.dispatchAction({type:"geoUnSelect",name:i})}),S([]),I(!1),B(!1)},[E,F,p,I,B,S,_]),a.useEffect(()=>{if(!u||!m.current)return;D(m.current).setOption({geo:{center:xe,zoom:ve}}),y(!1)},[u,y]),e.jsx("div",{ref:m,style:{...qe,...t}})}),Se=""+new URL("death-2a4fedcb.svg",import.meta.url).href,je=""+new URL("cloud-ccf5761c.svg",import.meta.url).href;const _e=3e3;function Je(){const[t,n]=a.useState(0),[c,o]=a.useState(0),r=pe(l=>l.count);return a.useEffect(()=>{if(r<=t)return;const l=50,d=Math.floor(_e/l/2),j=r-t,g=Math.floor(j/d),x=j%d;function m(f){if(f>=d){n(r);return}o(p=>p+g),setTimeout(()=>m(f+1),l)}o(f=>f+x),setTimeout(()=>m(0),l)},[r,t]),e.jsxs("div",{className:"death_cnt",children:[e.jsx("div",{className:"death_cnt__icon",children:e.jsx("img",{src:Se,alt:"death"})}),e.jsx("div",{className:"death_cnt__value",children:c})]})}const Qe=a.memo(()=>e.jsx("div",{className:"world_map__main",children:e.jsx(Ke,{})}));function en(){return e.jsx("div",{className:"explosion_scene",children:e.jsx("img",{src:je,alt:"cloud"})})}function nn(){const t=L(c=>c.setRelocateSignal);function n(){t(!0)}return e.jsx("div",{className:"relocate_btn",onClick:n,children:e.jsx(k,{children:"zoom_out_map"})})}function tn(){const[t,n]=a.useState(e.jsx(e.Fragment,{})),c=L(r=>r.launchSignal),o=Z(r=>r.isSmallScreen);return a.useEffect(()=>{c&&(n(e.jsx(en,{})),setTimeout(()=>{n(e.jsx(e.Fragment,{}))},_e))},[c]),e.jsxs("div",{className:"world_map",children:[e.jsx(Je,{}),o&&e.jsx(ne,{}),e.jsx(nn,{}),t,e.jsx(Qe,{})]})}function rn(){const[t,n]=a.useState(!0),c=R(g=>g.setLanguage),o=R(g=>g.setUiTranslation),r=R(g=>g.setDialogue),l=Z(g=>g.isSmallScreen),d=Z(g=>g.setIsSmallScreen),j=a.useCallback(async g=>{const x=g.map(m=>new Promise((f,p)=>{const S=new Image;S.src=m,S.onload=f,S.onerror=p}));await Promise.all(x),n(!1)},[]);return a.useEffect(()=>{t&&(o(ke),r(Pe),c("zh_cn"),j([de,ge,Se,je,he,re,se,te,ce,ae,oe,ie,le]).catch(console.error))},[t,c,o,r,j]),a.useEffect(()=>{d(document.body.clientWidth<=640),document.documentElement.style.setProperty("--vh",`${window.innerHeight*.01}px`),window.addEventListener("resize",()=>{d(document.body.clientWidth<=640),document.documentElement.style.setProperty("--vh",`${window.innerHeight*.01}px`)})},[d]),t?e.jsxs("div",{className:"loading_spinner",children:[e.jsx("div",{}),e.jsx("div",{}),e.jsx("div",{}),e.jsx("div",{}),e.jsx("div",{}),e.jsx("div",{}),e.jsx("div",{}),e.jsx("div",{})]}):e.jsxs(a.StrictMode,{children:[!l&&e.jsx(He,{}),e.jsx(tn,{}),l&&e.jsx(Ye,{})]})}H.createRoot(document.getElementById("root")).render(e.jsx(Ce.StrictMode,{children:e.jsx(rn,{})}));
