import{j as n,I,S as ie,M as A}from"./ui-1ada5940.js";import{c as le,d as M,r as i,a as ue}from"./react-d374afb9.js";import{w as de}from"./map-50aafcb0.js";import{u as ge,g as E,i as fe,r as he,a as me,b as pe,c as ve,d as xe}from"./echart-c7ccfee9.js";import{u as Se,d as _e}from"./lang-820134cf.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const d of a.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function c(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(r){if(r.ep)return;r.ep=!0;const a=c(r);fetch(r.href,a)}})();var W={},Z=le;W.createRoot=Z.createRoot,W.hydrateRoot=Z.hydrateRoot;const B=M()(t=>({type:"neco_arc",headImage:"",setCharacter:(e,c)=>t(()=>({type:e,headImage:c}))})),C=M()(t=>({language:"zh_cn",uiTranslation:null,dialogue:null,setLanguage:e=>t(()=>({language:e})),setUiTranslation:e=>t(()=>({uiTranslation:e})),setDialogue:e=>t(()=>({dialogue:e}))})),y=M()((t,e)=>({regionList:[],geoIndex:0,finalRegionList:[],setRegionList:c=>t(()=>({regionList:c})),updateFinalRegionList:()=>t(()=>({finalRegionList:e().regionList})),clearFinalRegionList:()=>t(()=>({finalRegionList:[]}))})),S=M()(t=>({prevCharacter:"neco_arc",prevRegion:"greeting",prevSubNumeric:"",prevLanguage:"zh_cn",curSentence:"",setPrevCharacter:e=>t({prevCharacter:e}),setPrevRegion:e=>t({prevRegion:e}),setPrevSubNumeric:e=>t({prevSubNumeric:e}),setPrevLanguage:e=>t({prevLanguage:e}),setCurSentence:e=>t(()=>({curSentence:e}))}));function V(t){const e=Array.from(t);for(let c=e.length-1;c>0;c-=1){const o=Math.floor(Math.random()*(c+1));[e[c],e[o]]=[e[o],e[c]]}return e}function q(t,e){return Math.floor(Math.random()*(e-t+1)+t)}function K(){const t=i.useRef(null),e=C(l=>l.dialogue),c=i.useRef(!0),o=S(l=>l.prevCharacter),r=S(l=>l.prevRegion),a=S(l=>l.prevSubNumeric),d=S(l=>l.prevLanguage),_=S(l=>l.curSentence),g=S(l=>l.setPrevCharacter),v=S(l=>l.setPrevRegion),j=S(l=>l.setPrevSubNumeric),p=S(l=>l.setPrevLanguage),h=S(l=>l.setCurSentence),R=B(l=>l.type),T=y(l=>l.finalRegionList),w=C(l=>l.language),O=y(l=>l.clearFinalRegionList);function U(){t.current&&t.current.classList.toggle("dialogue_bubble--invisible")}const x=i.useCallback((l,L,D,P)=>{if(!e)return"";const s=e[l];if(!s)return"";let u="";for(;L.length>0;){if(L=V(L),s[L[0]]){u=L[0];break}L.shift()}s[u]||(u="general");const m=s[u];let f="";if(D===""){const k=V(Object.keys(m));if(k.length<=0)return"";f=k[0]}else f=D;const N=m[f];return!N||!N[P]?"":(v(u),j(f),N[P])},[e,v,j]);return i.useEffect(()=>{!c.current||!e||(h(x(o,[r],a,d)),c.current=!1)},[e,o,r,a,d,h,x]),i.useEffect(()=>{R!==o&&(h(x(R,["greeting"],"",d)),g(R))},[R,o,d,h,x,g]),i.useEffect(()=>{T.length<=0||(h(x(o,T,"",d)),O())},[T,o,d,h,x,O]),i.useEffect(()=>{w!==d&&(h(x(o,[r],a,w)),p(w))},[w,o,r,a,d,h,x,p]),n.jsxs("div",{className:"dialogue_bubble",ref:t,children:[n.jsxs("div",{className:"dialogue_bubble__switch",onClick:U,children:[n.jsx(I,{children:"visibility"}),n.jsx(I,{children:"forward"}),n.jsx(I,{children:"visibility_off"})]}),n.jsx("div",{className:"dialogue_bubble__content",children:n.jsx("span",{children:_})})]})}const J=i.memo(()=>{const t=C(o=>o.language),e=C(o=>o.setLanguage);function c(o){e(o.target.value)}return n.jsxs("div",{className:"language_select",children:[n.jsx(I,{children:"translate"}),n.jsxs(ie,{value:t,onChange:c,children:[n.jsx(A,{value:"en",children:"English"}),n.jsx(A,{value:"zh_cn",children:"中文"}),n.jsx(A,{value:"ru",children:"Русский"})]})]})});function Y({text:t}){return n.jsx("div",{className:"console_label",children:t})}const Le=""+new URL("meowscarada-8f30ae9e.svg",import.meta.url).href,be=""+new URL("neco_arc-a0645750.svg",import.meta.url).href,je=""+new URL("lopunny-ed23b7c3.svg",import.meta.url).href,Ce=""+new URL("vaporeon-460baefb.svg",import.meta.url).href,ye=""+new URL("neco_arc-b9a98032.svg",import.meta.url).href,Re=""+new URL("lopunny-252a1372.svg",import.meta.url).href,we=""+new URL("meowscarada-b414bb30.svg",import.meta.url).href,Ne=""+new URL("vaporeon-0cf3d389.svg",import.meta.url).href;const z=[{icon:ye,name:"neco_arc",headImage:be},{icon:Ne,name:"vaporeon",headImage:Ce},{icon:Re,name:"lopunny",headImage:je},{icon:we,name:"meowscarada",headImage:Le}],Q=i.memo(()=>{const t=i.useRef(!0),e=B(r=>r.setCharacter),c=S(r=>r.prevCharacter),o=i.useCallback(r=>{var a;return(a=z.find(d=>d.name===r))==null?void 0:a.headImage},[]);return i.useEffect(()=>{if(!t.current)return;const r=o(c);r?e(c,r):e(z[0].name,z[0].headImage),t.current=!1},[c,e,o]),n.jsx("div",{className:"secretary_list",children:z.map((r,a)=>n.jsx("div",{className:"secretary_list__item",onClick:()=>e(r.name,r.headImage),children:n.jsx("img",{src:r.icon,alt:r.name})},a))})}),b=M()(t=>({launchSignal:!1,cancelSignal:!1,relocateSignal:!1,setLaunchSignal:e=>t(()=>({launchSignal:e})),setCancelSignal:e=>t(()=>({cancelSignal:e})),setRelocateSignal:e=>t(()=>({relocateSignal:e}))})),Ee=""+new URL("cancel-ac8fdd1a.svg",import.meta.url).href,Ie=""+new URL("launch-e6206def.svg",import.meta.url).href;function ee({isWithLabel:t,text:e=""}){const c=b(r=>r.setCancelSignal);function o(){c(!0)}return n.jsxs("div",{className:"launch_cancel_btn launch_btn",onClick:o,children:[n.jsx("div",{className:"launch_btn__circle",children:n.jsx("div",{children:n.jsx("img",{src:Ee,alt:"cancel"})})}),t&&n.jsx(Y,{text:e})]})}function ne({isWithLabel:t,text:e=""}){const c=b(d=>d.setLaunchSignal),o=y(d=>d.regionList),r=y(d=>d.updateFinalRegionList);function a(){r(),o.length!==0&&c(!0)}return n.jsxs("div",{className:"launch_confirm_btn launch_btn",onClick:a,children:[n.jsx("div",{className:"launch_btn__circle",children:n.jsx("div",{children:n.jsx("img",{src:Ie,alt:"launch"})})}),t&&n.jsx(Y,{text:e})]})}const Me=""+new URL("body-e1c4ec9d.svg",import.meta.url).href;function Te(){const t=B(e=>e.headImage);return n.jsxs("div",{className:"secretary",style:{opacity:1},children:[n.jsx("div",{className:"secretary__head",children:n.jsx("img",{src:t,alt:"head"})}),n.jsx("div",{className:"secretary__body",children:n.jsx("img",{src:Me,alt:"body"})})]})}function De(){return n.jsxs("div",{className:"secretary_main",children:[n.jsx(J,{}),n.jsx(K,{}),n.jsx(Te,{})]})}function ke(){return n.jsx("div",{className:"secretary_bg"})}function Oe(){return n.jsxs("div",{className:"secretary_display",children:[n.jsx(De,{}),n.jsx(ke,{})]})}function Pe(){const[t,e]=i.useState(!1),c=i.useRef(null);function o(){c.current&&(t?c.current.classList.remove("secretary_change_bar--extended"):c.current.classList.add("secretary_change_bar--extended"),e(!t))}return n.jsxs("div",{className:"secretary_change_bar",ref:c,children:[n.jsx(Q,{}),n.jsxs("div",{className:"secretary_change_bar__icon",onClick:o,children:[n.jsx("div",{children:n.jsx(I,{children:"arrow_back_ios_new"})}),n.jsx("div",{children:n.jsx(I,{children:"favorite"})})]})]})}function Ue(){return n.jsxs("div",{className:"secretary_scene",children:[n.jsx(Oe,{}),n.jsx(Pe,{})]})}function ze({text:t}){const e=y(c=>c.regionList);return n.jsxs("div",{className:"selected_region_cnt",children:[n.jsx("div",{className:"selected_region_cnt__value",children:e.length}),n.jsx(Y,{text:t})]})}function Be(){const t=C(c=>c.language),e=C(c=>c.uiTranslation);return n.jsxs("div",{className:"captain_console",children:[n.jsx(ee,{isWithLabel:!0,text:e?e.launch_cancel[t]:""}),n.jsx(ze,{text:e?e.selected_region[t]:""}),n.jsx(ne,{isWithLabel:!0,text:e?e.launch_confirm[t]:""})]})}function Fe(){return n.jsxs("div",{className:"captain_cabin",children:[n.jsx(Ue,{}),n.jsx(Be,{})]})}function Ae({regionListLength:t}){return n.jsxs(n.Fragment,{children:[n.jsx("div",{className:t>0?"console_wrapper console_wrapper__l":"console_wrapper console_wrapper__l console_wrapper--invisible",children:n.jsx(ee,{isWithLabel:!1})}),n.jsx("div",{className:t>0?"console_wrapper console_wrapper__r":"console_wrapper console_wrapper__r console_wrapper--invisible",children:n.jsx(ne,{isWithLabel:!1})})]})}function We(){const t=B(e=>e.headImage);return n.jsxs("div",{className:"secretary_scene--mobile",children:[n.jsx("div",{className:"secretary__head--mobile",children:n.jsx("img",{src:t,alt:"head"})}),n.jsx(K,{})]})}function $e(){const t=y(e=>e.regionList);return n.jsxs("div",{className:"captain_cabin--mobile",children:[n.jsx(Ae,{regionListLength:t.length}),n.jsx(We,{}),n.jsx(Q,{})]})}const te=M()(t=>({count:0,increase:e=>t(c=>({count:c.count+e}))})),$=M()(t=>({isSmallScreen:!1,setIsSmallScreen:e=>t(()=>({isSmallScreen:e}))}));ge([me,pe,ve,xe]);const H=1,X=50,re=5,se=[37.6175,55.7519],He={backgroundColor:"transparent",geo:{animation:!1,show:!0,roam:"move",map:"world",selectedMode:"multiple",scaleLimit:{min:H,max:X},itemStyle:{areaColor:"#DAD4B5"},label:{color:"white"},emphasis:{label:{color:"white",show:!0,textBorderWidth:3,textBorderColor:"black",fontSize:"1.5rem",fontFamily:"Times New Roman"},itemStyle:{areaColor:"#E25E3E"}},select:{label:{color:"white",show:!0,textBorderWidth:3,textBorderColor:"black",fontSize:"1.5rem",fontFamily:"Times New Roman"},itemStyle:{areaColor:"#C63D2F"}},center:se,zoom:re}},Xe={width:"100%",height:"100%",border:"none",padding:"0",margin:"0"};function Ye(t){let e=0;return t.forEach(c=>{switch(c){case"Russia":e+=q(0,5e3);break;case"Greenland":e+=0;break;case"Venezuela":e+=666;break;default:e+=q(5e3,2e4);break}}),e}function Ze(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function G(t,e){return{x:(t.x+e.x)/2,y:(t.y+e.y)/2}}const Ve=i.memo(({style:t,settings:e,loading:c,theme:o})=>{const r=i.useRef(0),a=i.useRef(5),d=i.useRef(null),_=i.useRef(0),g=i.useRef(null),v=i.useRef(null),j=y(s=>s.regionList),p=y(s=>s.setRegionList),h=b(s=>s.launchSignal),R=b(s=>s.setLaunchSignal),T=b(s=>s.cancelSignal),w=b(s=>s.setCancelSignal),O=te(s=>s.increase),U=b(s=>s.relocateSignal),x=b(s=>s.setRelocateSignal),l=i.useCallback(s=>{if(s.targetTouches.length<2||!g.current)return;const u=E(g.current),m=s.targetTouches[0],f=s.targetTouches[1],N={x:m.clientX,y:m.clientY},k={x:f.clientX,y:f.clientY},ae=G(N,k),F=Ze(N,k);if(!d.current){d.current=G(N,k);return}_.current===0&&(_.current=F);const oe=a.current*(F/_.current);a.current=Math.min(Math.max(oe,H),X),_.current=F,d.current=ae,r.current%2===0&&u.setOption({geo:{zoom:a.current}},{lazyUpdate:!0,silent:!0}),r.current+=1},[]),L=i.useCallback(()=>{_.current=0,d.current=null,r.current=0},[]),D=i.useCallback(s=>{if(!g.current)return;const m=E(g.current);s.deltaY<0?a.current*=1.2:a.current/=1.2,a.current=Math.min(Math.max(a.current,H),X),r.current%2===0&&m.setOption({geo:{zoom:a.current}},{lazyUpdate:!0,silent:!0}),r.current+=1},[]),P=i.useCallback(s=>{if(!g.current||s.target||!v.current)return;const u=E(g.current),m=u.getOption().geo[0].center;r.current%2===0&&u.setOption({geo:{center:[m[0]-(s.offsetX-v.current.x),m[1]+(s.offsetY-v.current.y)]}},{lazyUpdate:!0,silent:!0}),v.current={x:s.offsetX,y:s.offsetY},r.current+=1},[]);return i.useEffect(()=>{const s=g.current;let u=null;function m(){u==null||u.resize()}return s&&(u=fe(g.current,o),u.on("geoselectchanged",f=>{p(f.allSelected[0].name)}),u.getZr().on("mousemove",P),u.getZr().on("mousedown",f=>{v.current={x:f.offsetX,y:f.offsetY}}),u.getZr().on("mouseup",()=>{v.current=null,r.current=0}),s.addEventListener("touchmove",l),s.addEventListener("touchend",L),s.addEventListener("wheel",D),he("world",de)),window.addEventListener("resize",m),()=>{var f;u==null||u.dispose(),u==null||u.off("geoselectchanged"),(f=u==null?void 0:u.getZr())==null||f.off("mousemove"),window.removeEventListener("resize",m),s==null||s.removeEventListener("touchmove",l),s==null||s.removeEventListener("touchend",L),s==null||s.removeEventListener("wheel",D)}},[o,p,l,L,D,P]),i.useEffect(()=>{if(!g.current)return;E(g.current).setOption(He,e)},[e,o]),i.useEffect(()=>{if(!g.current)return;const s=E(g.current);c?s.showLoading():s.hideLoading()},[c,o]),i.useEffect(()=>{if(!g.current||!h&&!T)return;const s=E(g.current);h&&O(Ye(j)),j.forEach(u=>{s.dispatchAction({type:"geoUnSelect",name:u})}),p([]),R(!1),w(!1)},[h,T,j,R,w,p,O]),i.useEffect(()=>{if(!U||!g.current)return;E(g.current).setOption({geo:{center:se,zoom:re}}),x(!1)},[U,x]),n.jsx("div",{ref:g,style:{...Xe,...t}})}),qe=""+new URL("death-2a4fedcb.svg",import.meta.url).href,Ge=""+new URL("cloud-ccf5761c.svg",import.meta.url).href;const ce=3e3;function Ke(){const[t,e]=i.useState(0),[c,o]=i.useState(0),r=te(a=>a.count);return i.useEffect(()=>{if(r<=t)return;const a=50,d=Math.floor(ce/a/2),_=r-t,g=Math.floor(_/d),v=_%d;function j(p){if(p>=d){e(r);return}o(h=>h+g),setTimeout(()=>j(p+1),a)}o(p=>p+v),setTimeout(()=>j(0),a)},[r,t]),n.jsxs("div",{className:"death_cnt",children:[n.jsx("div",{className:"death_cnt__icon",children:n.jsx("img",{src:qe,alt:"death"})}),n.jsx("div",{className:"death_cnt__value",children:c})]})}const Je=i.memo(()=>n.jsx("div",{className:"world_map__main",children:n.jsx(Ve,{})}));function Qe(){return n.jsx("div",{className:"explosion_scene",children:n.jsx("img",{src:Ge,alt:"cloud"})})}function en(){const t=b(c=>c.setRelocateSignal);function e(){t(!0)}return n.jsx("div",{className:"relocate_btn",onClick:e,children:n.jsx(I,{children:"zoom_out_map"})})}function nn(){const[t,e]=i.useState(n.jsx(n.Fragment,{})),c=b(r=>r.launchSignal),o=$(r=>r.isSmallScreen);return i.useEffect(()=>{c&&(e(n.jsx(Qe,{})),setTimeout(()=>{e(n.jsx(n.Fragment,{}))},ce))},[c]),n.jsxs("div",{className:"world_map",children:[n.jsx(Ke,{}),o&&n.jsx(J,{}),n.jsx(en,{}),t,n.jsx(Je,{})]})}function tn(){const t=C(a=>a.setLanguage),e=C(a=>a.setUiTranslation),c=C(a=>a.setDialogue),o=$(a=>a.isSmallScreen),r=$(a=>a.setIsSmallScreen);return i.useEffect(()=>{e(Se),c(_e),t("zh_cn")},[t,e,c]),i.useEffect(()=>{r(document.body.clientWidth<=640),document.documentElement.style.setProperty("--vh",`${window.innerHeight*.01}px`),window.addEventListener("resize",()=>{r(document.body.clientWidth<=640),document.documentElement.style.setProperty("--vh",`${window.innerHeight*.01}px`)})},[r]),n.jsxs(i.StrictMode,{children:[!o&&n.jsx(Fe,{}),n.jsx(nn,{}),o&&n.jsx($e,{})]})}W.createRoot(document.getElementById("root")).render(n.jsx(ue.StrictMode,{children:n.jsx(tn,{})}));
