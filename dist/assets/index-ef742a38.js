import{j as e,I,S as _e,M as A}from"./ui-1ada5940.js";import{c as Le,d as M,r as i,a as be}from"./react-d374afb9.js";import{w as ye}from"./map-50aafcb0.js";import{u as Ce,g as E,i as Re,r as we,a as Ne,b as Ee,c as Ie,d as Me}from"./echart-c7ccfee9.js";import{u as Te,d as ke}from"./lang-820134cf.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const d of a.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function c(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(r){if(r.ep)return;r.ep=!0;const a=c(r);fetch(r.href,a)}})();var W={},Z=Le;W.createRoot=Z.createRoot,W.hydrateRoot=Z.hydrateRoot;const B=M()(t=>({type:"neco_arc",headImage:"",setCharacter:(n,c)=>t(()=>({type:n,headImage:c}))})),C=M()(t=>({language:"zh_cn",uiTranslation:null,dialogue:null,setLanguage:n=>t(()=>({language:n})),setUiTranslation:n=>t(()=>({uiTranslation:n})),setDialogue:n=>t(()=>({dialogue:n}))})),R=M()((t,n)=>({regionList:[],geoIndex:0,finalRegionList:[],setRegionList:c=>t(()=>({regionList:c})),updateFinalRegionList:()=>t(()=>({finalRegionList:n().regionList})),clearFinalRegionList:()=>t(()=>({finalRegionList:[]}))})),L=M()(t=>({prevCharacter:"neco_arc",prevRegion:"greeting",prevSubNumeric:"",prevLanguage:"zh_cn",curSentence:"",setPrevCharacter:n=>t({prevCharacter:n}),setPrevRegion:n=>t({prevRegion:n}),setPrevSubNumeric:n=>t({prevSubNumeric:n}),setPrevLanguage:n=>t({prevLanguage:n}),setCurSentence:n=>t(()=>({curSentence:n}))}));function V(t){const n=Array.from(t);for(let c=n.length-1;c>0;c-=1){const o=Math.floor(Math.random()*(c+1));[n[c],n[o]]=[n[o],n[c]]}return n}function q(t,n){return Math.floor(Math.random()*(n-t+1)+t)}function K(){const t=i.useRef(null),n=C(u=>u.dialogue),c=i.useRef(!0),o=L(u=>u.prevCharacter),r=L(u=>u.prevRegion),a=L(u=>u.prevSubNumeric),d=L(u=>u.prevLanguage),p=L(u=>u.curSentence),l=L(u=>u.setPrevCharacter),v=L(u=>u.setPrevRegion),S=L(u=>u.setPrevSubNumeric),h=L(u=>u.setPrevLanguage),f=L(u=>u.setCurSentence),j=B(u=>u.type),T=R(u=>u.finalRegionList),w=C(u=>u.language),P=R(u=>u.clearFinalRegionList);function z(){t.current&&t.current.classList.toggle("dialogue_bubble--invisible")}const _=i.useCallback((u,b,k,U)=>{if(!n)return"";const s=n[u];if(!s)return"";let g="";for(;b.length>0;){if(b=V(b),s[b[0]]){g=b[0];break}b.shift()}s[g]||(g="general");const x=s[g];let m="";if(k===""){const D=V(Object.keys(x));if(D.length<=0)return"";m=D[0]}else m=k;const N=x[m];return!N||!N[U]?"":(v(g),S(m),N[U])},[n,v,S]);return i.useEffect(()=>{!c.current||!n||(f(_(o,[r],a,d)),c.current=!1)},[n,o,r,a,d,f,_]),i.useEffect(()=>{j!==o&&(f(_(j,["greeting"],"",d)),l(j))},[j,o,d,f,_,l]),i.useEffect(()=>{T.length<=0||(f(_(o,T,"",d)),P())},[T,o,d,f,_,P]),i.useEffect(()=>{w!==d&&(f(_(o,[r],a,w)),h(w))},[w,o,r,a,d,f,_,h]),e.jsxs("div",{className:"dialogue_bubble",ref:t,children:[e.jsxs("div",{className:"dialogue_bubble__switch",onClick:z,children:[e.jsx(I,{children:"visibility"}),e.jsx(I,{children:"forward"}),e.jsx(I,{children:"visibility_off"})]}),e.jsx("div",{className:"dialogue_bubble__content",children:e.jsx("span",{children:p})})]})}const J=i.memo(()=>{const t=C(o=>o.language),n=C(o=>o.setLanguage);function c(o){n(o.target.value)}return e.jsxs("div",{className:"language_select",children:[e.jsx(I,{children:"translate"}),e.jsxs(_e,{value:t,onChange:c,children:[e.jsx(A,{value:"en",children:"English"}),e.jsx(A,{value:"zh_cn",children:"中文"}),e.jsx(A,{value:"ru",children:"Русский"})]})]})});function Y({text:t}){return e.jsx("div",{className:"console_label",children:t})}const Q=""+new URL("meowscarada-8f30ae9e.svg",import.meta.url).href,ee=""+new URL("neco_arc-a0645750.svg",import.meta.url).href,ne=""+new URL("lopunny-ed23b7c3.svg",import.meta.url).href,te=""+new URL("vaporeon-460baefb.svg",import.meta.url).href,re=""+new URL("neco_arc-b9a98032.svg",import.meta.url).href,se=""+new URL("lopunny-252a1372.svg",import.meta.url).href,ce=""+new URL("meowscarada-b414bb30.svg",import.meta.url).href,ae=""+new URL("vaporeon-0cf3d389.svg",import.meta.url).href;const O=[{icon:re,name:"neco_arc",headImage:ee},{icon:ae,name:"vaporeon",headImage:te},{icon:se,name:"lopunny",headImage:ne},{icon:ce,name:"meowscarada",headImage:Q}],oe=i.memo(()=>{const t=i.useRef(!0),n=B(r=>r.setCharacter),c=L(r=>r.prevCharacter),o=i.useCallback(r=>{var a;return(a=O.find(d=>d.name===r))==null?void 0:a.headImage},[]);return i.useEffect(()=>{if(!t.current)return;const r=o(c);r?n(c,r):n(O[0].name,O[0].headImage),t.current=!1},[c,n,o]),e.jsx("div",{className:"secretary_list",children:O.map((r,a)=>e.jsx("div",{className:"secretary_list__item",onClick:()=>n(r.name,r.headImage),children:e.jsx("img",{src:r.icon,alt:r.name})},a))})}),y=M()(t=>({launchSignal:!1,cancelSignal:!1,relocateSignal:!1,setLaunchSignal:n=>t(()=>({launchSignal:n})),setCancelSignal:n=>t(()=>({cancelSignal:n})),setRelocateSignal:n=>t(()=>({relocateSignal:n}))})),ie=""+new URL("cancel-ac8fdd1a.svg",import.meta.url).href,le=""+new URL("launch-e6206def.svg",import.meta.url).href;function ue({isWithLabel:t,text:n=""}){const c=y(r=>r.setCancelSignal);function o(){c(!0)}return e.jsxs("div",{className:"launch_cancel_btn launch_btn",onClick:o,children:[e.jsx("div",{className:"launch_btn__circle",children:e.jsx("div",{children:e.jsx("img",{src:ie,alt:"cancel"})})}),t&&e.jsx(Y,{text:n})]})}function de({isWithLabel:t,text:n=""}){const c=y(d=>d.setLaunchSignal),o=R(d=>d.regionList),r=R(d=>d.updateFinalRegionList);function a(){r(),o.length!==0&&c(!0)}return e.jsxs("div",{className:"launch_confirm_btn launch_btn",onClick:a,children:[e.jsx("div",{className:"launch_btn__circle",children:e.jsx("div",{children:e.jsx("img",{src:le,alt:"launch"})})}),t&&e.jsx(Y,{text:n})]})}const ge=""+new URL("body-e1c4ec9d.svg",import.meta.url).href;function De(){const t=B(n=>n.headImage);return e.jsxs("div",{className:"secretary",style:{opacity:1},children:[e.jsx("div",{className:"secretary__head",children:e.jsx("img",{src:t,alt:"head"})}),e.jsx("div",{className:"secretary__body",children:e.jsx("img",{src:ge,alt:"body"})})]})}function Pe(){return e.jsxs("div",{className:"secretary_main",children:[e.jsx(J,{}),e.jsx(K,{}),e.jsx(De,{})]})}function Ue(){return e.jsx("div",{className:"secretary_bg"})}function ze(){return e.jsxs("div",{className:"secretary_display",children:[e.jsx(Pe,{}),e.jsx(Ue,{})]})}function Oe(){const[t,n]=i.useState(!1),c=i.useRef(null);function o(){c.current&&(t?c.current.classList.remove("secretary_change_bar--extended"):c.current.classList.add("secretary_change_bar--extended"),n(!t))}return e.jsxs("div",{className:"secretary_change_bar",ref:c,children:[e.jsx(oe,{}),e.jsxs("div",{className:"secretary_change_bar__icon",onClick:o,children:[e.jsx("div",{children:e.jsx(I,{children:"arrow_back_ios_new"})}),e.jsx("div",{children:e.jsx(I,{children:"favorite"})})]})]})}function Be(){return e.jsxs("div",{className:"secretary_scene",children:[e.jsx(ze,{}),e.jsx(Oe,{})]})}function Fe({text:t}){const n=R(c=>c.regionList);return e.jsxs("div",{className:"selected_region_cnt",children:[e.jsx("div",{className:"selected_region_cnt__value",children:n.length}),e.jsx(Y,{text:t})]})}function Ae(){const t=C(c=>c.language),n=C(c=>c.uiTranslation);return e.jsxs("div",{className:"captain_console",children:[e.jsx(ue,{isWithLabel:!0,text:n?n.launch_cancel[t]:""}),e.jsx(Fe,{text:n?n.selected_region[t]:""}),e.jsx(de,{isWithLabel:!0,text:n?n.launch_confirm[t]:""})]})}function We(){return e.jsxs("div",{className:"captain_cabin",children:[e.jsx(Be,{}),e.jsx(Ae,{})]})}function $e({regionListLength:t}){return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:t>0?"console_wrapper console_wrapper__l":"console_wrapper console_wrapper__l console_wrapper--invisible",children:e.jsx(ue,{isWithLabel:!1})}),e.jsx("div",{className:t>0?"console_wrapper console_wrapper__r":"console_wrapper console_wrapper__r console_wrapper--invisible",children:e.jsx(de,{isWithLabel:!1})})]})}function He(){const t=B(n=>n.headImage);return e.jsxs("div",{className:"secretary_scene--mobile",children:[e.jsx("div",{className:"secretary__head--mobile",children:e.jsx("img",{src:t,alt:"head"})}),e.jsx(K,{})]})}function Xe(){const t=R(n=>n.regionList);return e.jsxs("div",{className:"captain_cabin--mobile",children:[e.jsx($e,{regionListLength:t.length}),e.jsx(He,{}),e.jsx(oe,{})]})}const me=M()(t=>({count:0,increase:n=>t(c=>({count:c.count+n}))})),$=M()(t=>({isSmallScreen:!1,setIsSmallScreen:n=>t(()=>({isSmallScreen:n}))}));Ce([Ne,Ee,Ie,Me]);const H=1,X=50,fe=5,he=[37.6175,55.7519],Ye={backgroundColor:"transparent",geo:{animation:!1,show:!0,roam:"move",map:"world",selectedMode:"multiple",scaleLimit:{min:H,max:X},itemStyle:{areaColor:"#DAD4B5"},label:{color:"white"},emphasis:{label:{color:"white",show:!0,textBorderWidth:3,textBorderColor:"black",fontSize:"1.5rem",fontFamily:"Times New Roman"},itemStyle:{areaColor:"#E25E3E"}},select:{label:{color:"white",show:!0,textBorderWidth:3,textBorderColor:"black",fontSize:"1.5rem",fontFamily:"Times New Roman"},itemStyle:{areaColor:"#C63D2F"}},center:he,zoom:fe}},Ze={width:"100%",height:"100%",border:"none",padding:"0",margin:"0"};function Ve(t){let n=0;return t.forEach(c=>{switch(c){case"Russia":n+=q(0,5e3);break;case"Greenland":n+=0;break;case"Venezuela":n+=666;break;default:n+=q(5e3,2e4);break}}),n}function qe(t,n){return Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2))}function G(t,n){return{x:(t.x+n.x)/2,y:(t.y+n.y)/2}}const Ge=i.memo(({style:t,settings:n,loading:c,theme:o})=>{const r=i.useRef(0),a=i.useRef(5),d=i.useRef(null),p=i.useRef(0),l=i.useRef(null),v=i.useRef(null),S=R(s=>s.regionList),h=R(s=>s.setRegionList),f=y(s=>s.launchSignal),j=y(s=>s.setLaunchSignal),T=y(s=>s.cancelSignal),w=y(s=>s.setCancelSignal),P=me(s=>s.increase),z=y(s=>s.relocateSignal),_=y(s=>s.setRelocateSignal),u=i.useCallback(s=>{if(s.targetTouches.length<2||!l.current)return;const g=E(l.current),x=s.targetTouches[0],m=s.targetTouches[1],N={x:x.clientX,y:x.clientY},D={x:m.clientX,y:m.clientY},Se=G(N,D),F=qe(N,D);if(!d.current){d.current=G(N,D);return}p.current===0&&(p.current=F);const je=a.current*(F/p.current);a.current=Math.min(Math.max(je,H),X),p.current=F,d.current=Se,r.current%2===0&&g.setOption({geo:{zoom:a.current}},{lazyUpdate:!0,silent:!0}),r.current+=1},[]),b=i.useCallback(()=>{p.current=0,d.current=null,r.current=0},[]),k=i.useCallback(s=>{if(!l.current)return;const g=1.2,x=E(l.current);s.deltaY<0?a.current*=g:a.current/=g,a.current=Math.min(Math.max(a.current,H),X),r.current%2===0&&x.setOption({geo:{zoom:a.current}},{lazyUpdate:!0,silent:!0}),r.current+=1},[]),U=i.useCallback(s=>{if(!l.current||s.target||!v.current)return;const g=5,x=E(l.current),m=x.getOption().geo[0].center;r.current%2===0&&x.setOption({geo:{center:[m[0]-(s.offsetX-v.current.x)*(g/a.current),m[1]+(s.offsetY-v.current.y)*(g/a.current)]}},{lazyUpdate:!0,silent:!0}),v.current={x:s.offsetX,y:s.offsetY},r.current+=1},[]);return i.useEffect(()=>{const s=l.current;let g=null;function x(){g==null||g.resize()}return s&&(g=Re(l.current,o),g.on("geoselectchanged",m=>{h(m.allSelected[0].name)}),g.getZr().on("mousemove",U),g.getZr().on("mousedown",m=>{v.current={x:m.offsetX,y:m.offsetY}}),g.getZr().on("mouseup",()=>{v.current=null,r.current=0}),s.addEventListener("touchmove",u),s.addEventListener("touchend",b),s.addEventListener("wheel",k),we("world",ye)),window.addEventListener("resize",x),()=>{var m;g==null||g.dispose(),g==null||g.off("geoselectchanged"),(m=g==null?void 0:g.getZr())==null||m.off("mousemove"),window.removeEventListener("resize",x),s==null||s.removeEventListener("touchmove",u),s==null||s.removeEventListener("touchend",b),s==null||s.removeEventListener("wheel",k)}},[o,h,u,b,k,U]),i.useEffect(()=>{if(!l.current)return;E(l.current).setOption(Ye,n)},[n,o]),i.useEffect(()=>{if(!l.current)return;const s=E(l.current);c?s.showLoading():s.hideLoading()},[c,o]),i.useEffect(()=>{if(!l.current||!f&&!T)return;const s=E(l.current);f&&P(Ve(S)),S.forEach(g=>{s.dispatchAction({type:"geoUnSelect",name:g})}),h([]),j(!1),w(!1)},[f,T,S,j,w,h,P]),i.useEffect(()=>{if(!z||!l.current)return;E(l.current).setOption({geo:{center:he,zoom:fe}}),_(!1)},[z,_]),e.jsx("div",{ref:l,style:{...Ze,...t}})}),pe=""+new URL("death-2a4fedcb.svg",import.meta.url).href,ve=""+new URL("cloud-ccf5761c.svg",import.meta.url).href;const xe=3e3;function Ke(){const[t,n]=i.useState(0),[c,o]=i.useState(0),r=me(a=>a.count);return i.useEffect(()=>{if(r<=t)return;const a=50,d=Math.floor(xe/a/2),p=r-t,l=Math.floor(p/d),v=p%d;function S(h){if(h>=d){n(r);return}o(f=>f+l),setTimeout(()=>S(h+1),a)}o(h=>h+v),setTimeout(()=>S(0),a)},[r,t]),e.jsxs("div",{className:"death_cnt",children:[e.jsx("div",{className:"death_cnt__icon",children:e.jsx("img",{src:pe,alt:"death"})}),e.jsx("div",{className:"death_cnt__value",children:c})]})}const Je=i.memo(()=>e.jsx("div",{className:"world_map__main",children:e.jsx(Ge,{})}));function Qe(){return e.jsx("div",{className:"explosion_scene",children:e.jsx("img",{src:ve,alt:"cloud"})})}function en(){const t=y(c=>c.setRelocateSignal);function n(){t(!0)}return e.jsx("div",{className:"relocate_btn",onClick:n,children:e.jsx(I,{children:"zoom_out_map"})})}function nn(){const[t,n]=i.useState(e.jsx(e.Fragment,{})),c=y(r=>r.launchSignal),o=$(r=>r.isSmallScreen);return i.useEffect(()=>{c&&(n(e.jsx(Qe,{})),setTimeout(()=>{n(e.jsx(e.Fragment,{}))},xe))},[c]),e.jsxs("div",{className:"world_map",children:[e.jsx(Ke,{}),o&&e.jsx(J,{}),e.jsx(en,{}),t,e.jsx(Je,{})]})}function tn(){const[t,n]=i.useState(!0),c=C(l=>l.setLanguage),o=C(l=>l.setUiTranslation),r=C(l=>l.setDialogue),a=$(l=>l.isSmallScreen),d=$(l=>l.setIsSmallScreen),p=i.useCallback(async l=>{const v=l.map(S=>new Promise((h,f)=>{const j=new Image;j.src=S,j.onload=h,j.onerror=f}));await Promise.all(v),n(!1)},[]);return i.useEffect(()=>{t&&(o(Te),r(ke),c("zh_cn"),p([ie,le,pe,ve,ge,ee,ne,Q,te,re,se,ce,ae]).catch(console.error))},[t,c,o,r,p]),i.useEffect(()=>{d(document.body.clientWidth<=640),document.documentElement.style.setProperty("--vh",`${window.innerHeight*.01}px`),window.addEventListener("resize",()=>{d(document.body.clientWidth<=640),document.documentElement.style.setProperty("--vh",`${window.innerHeight*.01}px`)})},[d]),t?e.jsxs("div",{className:"loading_spinner",children:[e.jsx("div",{}),e.jsx("div",{}),e.jsx("div",{}),e.jsx("div",{}),e.jsx("div",{}),e.jsx("div",{}),e.jsx("div",{}),e.jsx("div",{})]}):e.jsxs(i.StrictMode,{children:[!a&&e.jsx(We,{}),e.jsx(nn,{}),a&&e.jsx(Xe,{})]})}W.createRoot(document.getElementById("root")).render(e.jsx(be.StrictMode,{children:e.jsx(tn,{})}));
